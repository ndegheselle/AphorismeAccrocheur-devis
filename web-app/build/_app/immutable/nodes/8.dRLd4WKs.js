import{t as V,a as Q}from"../chunks/O273lVJd.js";import{p as we,b as ce,c as e,s as t,t as $e,g as l,a as ke,e as B,r as a,n as oa,f as na}from"../chunks/5qLNcEMJ.js";import{d as Ce,s as ze,a as Le,b as c}from"../chunks/4hdA9Hqv.js";import{i as he}from"../chunks/HbRG54zj.js";import{s as Be,r as C}from"../chunks/CSdkdAZB.js";import{p as x}from"../chunks/DEnCKr3U.js";import{b as Ee}from"../chunks/BV0wr5sm.js";import{B as Me,r as F,S as da}from"../chunks/mhlbfDLx.js";import{b as ye}from"../chunks/CjwIIwk2.js";import{t as Oe}from"../chunks/BkYxRAWn.js";import{o as Ue}from"../chunks/z1zQKN8N.js";import{s as z}from"../chunks/BcuBeYSt.js";import{a as ca,b as L}from"../chunks/DNmfbV_I.js";import{g as va}from"../chunks/DmrV5KAy.js";import{a as pa,c as ua}from"../chunks/y7u0JUKb.js";let o=x({name:"",adress:"",city:"",zipCode:"",email:"",phone:"",logo:""});function ma(i){return Object.keys(o).forEach(d=>{o[d]=""}),(!i.name||i.name.trim()==="")&&(o.businessName="Le nom de l'entreprise est obligatoire"),(!i.adress||i.adress.trim()==="")&&(o.adress="L'adresse est obligatoire"),(!i.city||i.city.trim()==="")&&(o.city="La ville est obligatoire"),!i.zipCode||i.zipCode.trim()===""?o.zipCode="Le code postal est obligatoire":/^\d{5}$/.test(i.zipCode)||(o.zipCode="Le code postal doit contenir 5 chiffres"),i.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.email)&&(o.email="L'adresse email n'est pas valide"),i.phone&&(/^(?:(?:\+|00)33|0)\s*[1-9](?:[\s.-]*\d{2}){4}$/.test(i.phone)||(o.phone="Le numéro de téléphone n'est pas valide")),Object.values(o).some(d=>d!=="")}var fa=(i,d)=>d(),_a=(i,d)=>d(),ba=(i,d)=>d(),ga=V('<dialog class="modal"><fieldset class="fieldset w-md bg-base-200 border border-base-300 p-4 rounded-box mx-auto mb-2"><legend class="fieldset-legend"> </legend> <div class="flex gap-2"><div class="avatar"><div class="w-24 rounded"><img alt="Logo"></div></div> <div class="w-full"><label class="fieldset-label" for="logo"> </label> <input type="file" class="file-input w-full" name="logo" accept="image/*"> <p class="fieldset-label">Taille maximum 50MB</p></div></div> <label class="fieldset-label" for="name"> </label> <input type="text" name="name"> <p class="fieldset-label text-error"> </p> <label class="fieldset-label" for="adress"> </label> <input type="text" name="adress"> <p class="fieldset-label text-error"> </p> <div class="grid grid-cols-3 gap-2"><div class="col-span-2"><label class="fieldset-label" for="city"> </label> <input type="text" name="city"> <p class="fieldset-label text-error"> </p></div> <div class="col-span-1"><label class="fieldset-label" for="zipCode"> </label> <input type="text" name="zipCode"> <p class="fieldset-label text-error"> </p></div></div> <label class="fieldset-label" for="email"> </label> <input type="email" name="email"> <p class="fieldset-label text-error"> </p> <label class="fieldset-label" for="phone"> </label> <input type="tel" name="phone"> <p class="fieldset-label text-error"> </p> <div class="modal-action"><button class="btn"> </button> <button class="btn btn-primary"> </button></div></fieldset> <div class="modal-backdrop"><button>Close</button></div></dialog>');function xa(i,d){we(d,!0);const[W,X]=ze(),v=()=>Le(Oe,"$t",W);let s=ce(x(new Me)),u=ce(null),E,f;Ue(async()=>{let r=await F.getFirstOrDefault();r&&B(s,x(r))});async function N(){if(!ma(l(s)))try{l(u)&&l(u).length>0&&(l(s).logoId=await F.uploadLogo(l(u)[0])),l(s).exists?B(s,x(await F.update(l(s)))):B(s,x(await F.create(l(s)))),va("/estimates")}catch{pa.error(v()("business.edit.error"))}}function M(r){return B(s,x(r)),E=ua(),f.show(),E.promise}function h(r=!1){f.close(),E.resolve(r?l(s):null)}var m=ga(),y=e(m),w=e(y),P=e(w,!0);a(w);var _=t(w,2),$=e(_),R=e($),S=e(R);a(R),a($);var O=t($,2),U=e(O),I=e(U);a(U);var T=t(U,2);oa(2),a(O),a(_);var b=t(_,2),Y=e(b);a(b);var k=t(b,2);C(k);let q;var D=t(k,2),Z=e(D,!0);a(D);var j=t(D,2),n=e(j);a(j);var p=t(j,2);C(p);let g;var ee=t(p,2),De=e(ee,!0);a(ee);var ae=t(ee,2),te=e(ae),se=e(te),je=e(se);a(se);var A=t(se,2);C(A);let ve;var pe=t(A,2),Fe=e(pe,!0);a(pe),a(te);var ue=t(te,2),le=e(ue),Ne=e(le);a(le);var G=t(le,2);C(G);let me;var fe=t(G,2),Pe=e(fe,!0);a(fe),a(ue),a(ae);var re=t(ae,2),Re=e(re,!0);a(re);var H=t(re,2);C(H);let _e;var ie=t(H,2),Se=e(ie,!0);a(ie);var oe=t(ie,2),Ie=e(oe,!0);a(oe);var J=t(oe,2);C(J);let be;var ne=t(J,2),Te=e(ne,!0);a(ne);var ge=t(ne,2),K=e(ge);K.__click=[fa,h];var qe=e(K,!0);a(K);var de=t(K,2);de.__click=[_a,N];var Ae=e(de,!0);a(de),a(ge),a(y);var xe=t(y,2),Ge=e(xe);Ge.__click=[ba,h],a(xe),a(m),Ee(m,r=>f=r,()=>f),$e((r,Je,Ke,Qe,Ve,We,Xe,Ye,Ze,ea,aa,ta,sa,la,ra,ia)=>{c(P,r),Be(S,"src",l(s).logoUrl),c(I,`${Je??""} *`),c(Y,`${Ke??""} *`),q=z(k,1,"input w-full",null,q,Qe),c(Z,o.name),c(n,`${Ve??""} *`),g=z(p,1,"input w-full",null,g,We),c(De,o.adress),c(je,`${Xe??""} *`),ve=z(A,1,"input w-full",null,ve,Ye),c(Fe,o.city),c(Ne,`${Ze??""} *`),me=z(G,1,"input w-full",null,me,ea),c(Pe,o.zipCode),c(Re,aa),_e=z(H,1,"input w-full",null,_e,ta),c(Se,o.email),c(Ie,sa),be=z(J,1,"input w-full",null,be,la),c(Te,o.phone),c(qe,ra),c(Ae,ia)},[()=>v()("business.title"),()=>v()("business.logo"),()=>v()("business.name"),()=>({"input-error":o.name}),()=>v()("business.adress"),()=>({"input-error":o.adress}),()=>v()("business.city"),()=>({"input-error":o.city}),()=>v()("business.zipCode"),()=>({"input-error":o.zipCode}),()=>v()("business.email"),()=>({"input-error":o.email}),()=>v()("business.phone"),()=>({"input-error":o.phone}),()=>v()("common.cancel"),()=>l(s).exists?v()("common.update"):v()("common.create")]),ca(T,()=>l(u),r=>B(u,r)),L(k,()=>l(s).name,r=>l(s).name=r),L(p,()=>l(s).adress,r=>l(s).adress=r),L(A,()=>l(s).city,r=>l(s).city=r),L(G,()=>l(s).zipCode,r=>l(s).zipCode=r),L(H,()=>l(s).email,r=>l(s).email=r),L(J,()=>l(s).phone,r=>l(s).phone=r),Q(i,m);var He=ke({show:M,close:h});return X(),He}Ce(["click"]);var ha=(i,d)=>d(),ya=V('<button class="ms-auto btn btn-sm btn-circle ms-auto" aria-label="Modifier entreprise"><i class="fa-solid fa-edit"></i></button>'),wa=(i,d)=>d(),$a=V(`<div class="flex flex-col m-auto gap-2"><span class="text-sm m-auto opacity-60">L'entreprise n'est pas encore configurée.</span> <button class="btn btn-primary">Configurer</button></div>`),ka=V('<div class="container mx-auto py-4"><div class="grid grid-cols-1 lg:grid-cols-3 gap-2"><div class="card bg-base-200 shadow-md"><div class="card-body"><h2 class="card-title">Utilisateur</h2> <div class="grid grid-cols-6 gap-2"><img class="w-16" src="https://avatar.iran.liara.run/public"> <div><h3 class="font-bold text-slate-600">Nom</h3> <span> </span></div> <div class="col-span-4"><h3 class="font-bold text-slate-600">E-mail</h3> <span> </span></div></div></div></div> <div class="card bg-base-200 col-span-2 shadow-md"><div class="card-body"><div class="flex"><h2 class="card-title">Entreprise</h2> <!></div> <!></div></div></div></div> <!>',1);function Ia(i,d){we(d,!0);const[W,X]=ze(),v=()=>Le(Oe,"$t",W);let s=ce(null),u;Ue(async()=>{let n=await F.getFirstOrDefault();n?B(s,x(n)):f()});function E(){l(s)&&u.show(l(s))}function f(){u.show(new Me)}var N=ka(),M=na(N),h=e(M),m=e(h),y=e(m),w=t(e(y),2),P=e(w),_=t(P,2),$=t(e(_),2),R=e($,!0);a($),a(_);var S=t(_,2),O=t(e(S),2),U=e(O,!0);a(O),a(S),a(w),a(y),a(m);var I=t(m,2),T=e(I),b=e(T),Y=t(e(b),2);{var k=n=>{var p=ya();p.__click=[ha,E],Q(n,p)};he(Y,n=>{l(s)&&n(k)})}a(b);var q=t(b,2);{var D=n=>{da(n,{get business(){return l(s)}})},Z=n=>{var p=$a(),g=t(e(p),2);g.__click=[wa,f],a(p),Q(n,p)};he(q,n=>{l(s)?n(D):n(Z,!1)})}a(T),a(I),a(h),a(M);var j=t(M,2);Ee(xa(j,{}),n=>u=n,()=>u),$e(n=>{var p,g;Be(P,"alt",n),c(R,(p=ye.currentUser)==null?void 0:p.name),c(U,(g=ye.currentUser)==null?void 0:g.email)},[()=>v()("user.avatar.alt")]),Q(i,N),ke(),X()}Ce(["click"]);export{Ia as component};
